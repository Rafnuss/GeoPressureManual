<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="Learn how to use GeoPressureR with a Swainson’s Warbler and a Great Reed Warbler.">
<title>3&nbsp; Trajectory – A User Manual for GeoPressureR</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./light-map.html" rel="next">
<link href="./pressure-map.html" rel="prev">
<link href=".//assets/favicon.svg" rel="icon" type="image/svg+xml">
<script src="site_libs/cookie-consent/cookie-consent.js"></script>
<link href="site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-9b53bbf6bc1eaa73b7af1d4afddc3bf9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-NJ17NCTPB5"></script><script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-NJ17NCTPB5', { 'anonymize_ip': true});
</script><script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script><script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-1.3.1/leaflet.js"></script><link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="site_libs/proj4-2.6.2/proj4.min.js"></script><script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-binding-2.2.2/leaflet.js"></script><script src="site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script><script src="site_libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<meta property="og:title" content="3&nbsp; Trajectory – A User Manual for GeoPressureR">
<meta property="og:description" content="Learn how to use GeoPressureR with a Swainson’s Warbler and a Great Reed Warbler.">
<meta property="og:image" content="https://raphaelnussbaumer.com/GeoPressureManual/trajectory_files/figure-html/unnamed-chunk-2-1.png">
<meta property="og:site_name" content="A User Manual for GeoPressureR">
<meta property="og:image:height" content="960">
<meta property="og:image:width" content="1344">
<meta name="twitter:title" content="3&nbsp; Trajectory – A User Manual for GeoPressureR">
<meta name="twitter:description" content="Learn how to use GeoPressureR with a Swainson’s Warbler and a Great Reed Warbler.">
<meta name="twitter:image" content="https://raphaelnussbaumer.com/GeoPressureManual/trajectory_files/figure-html/unnamed-chunk-2-1.png">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./tag-object.html">Basic tutorial</a></li><li class="breadcrumb-item"><a href="./trajectory.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Trajectory</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">A User Manual for GeoPressureR</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/Rafnuss/GeoPressureManual" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
</div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Basic tutorial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tag-object.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Tag object</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pressure-map.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Pressure map</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./trajectory.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Trajectory</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced tutorial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./light-map.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Light map</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./trajectory-with-wind.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Trajectory with wind</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Labelling tools</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pressurepath.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Pressurepath</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geopressureviz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">GeoPressureViz</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./labelling-tracks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Labelling tracks</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">GeoPressureTemplate</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geopressuretemplate-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geopressuretemplate-label.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Tag label</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geopressuretemplate-twilight.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Twilight label</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geopressuretemplate-wind.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Download wind</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geopressuretemplate-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Workflow</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">GeoLocator DP</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geolocator-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geolocator-create.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Create</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geolocator-read.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Read and use</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Resources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability-aggregation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Probability aggregation</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
<div class="quarto-sidebar-footer"><div class="sidebar-footer-item">
<p><a href="https://github.com/Rafnuss/GeoPressureTemplate" target="_blank" class="btn btn-sm btn-outline-primary" role="button">Start your own study</a></p>
</div></div></nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#background-on-movement-modeling" id="toc-background-on-movement-modeling" class="nav-link active" data-scroll-target="#background-on-movement-modeling"><span class="header-section-number">3.1</span> Background on movement modeling</a></li>
  <li><a href="#create-the-graph" id="toc-create-the-graph" class="nav-link" data-scroll-target="#create-the-graph"><span class="header-section-number">3.2</span> Create the graph</a></li>
  <li><a href="#set-movement-model" id="toc-set-movement-model" class="nav-link" data-scroll-target="#set-movement-model"><span class="header-section-number">3.3</span> Set movement model</a></li>
  <li>
<a href="#products" id="toc-products" class="nav-link" data-scroll-target="#products"><span class="header-section-number">3.4</span> Products</a>
  <ul class="collapse">
<li><a href="#product-1-most-likely-path" id="toc-product-1-most-likely-path" class="nav-link" data-scroll-target="#product-1-most-likely-path"><span class="header-section-number">3.4.1</span> Product 1: Most likely path</a></li>
  <li><a href="#product-2-marginal-probability-map" id="toc-product-2-marginal-probability-map" class="nav-link" data-scroll-target="#product-2-marginal-probability-map"><span class="header-section-number">3.4.2</span> Product 2: Marginal probability map</a></li>
  <li><a href="#product-3-simulated-paths" id="toc-product-3-simulated-paths" class="nav-link" data-scroll-target="#product-3-simulated-paths"><span class="header-section-number">3.4.3</span> Product 3: Simulated paths</a></li>
  </ul>
</li>
  <li><a href="#save" id="toc-save" class="nav-link" data-scroll-target="#save"><span class="header-section-number">3.5</span> Save</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/Rafnuss/GeoPressureManual/issues" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./tag-object.html">Basic tutorial</a></li><li class="breadcrumb-item"><a href="./trajectory.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Trajectory</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Trajectory</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>In this last chapter of the basic tutorial, we model the full trajectory of the Swainson’s Warbler by combining the observation model of pressure with a movement model of flight accounting for likely speed to constrain possible distances between stationary periods. To do so, we use a highly optimized <a href="https://en.wikipedia.org/wiki/Hidden_Markov_model" target="_blank">Hidden Markov model</a> presented in <span class="citation" data-cites="Nussbaumer2023b">Nussbaumer et al. (<a href="resources.html#ref-Nussbaumer2023b" role="doc-biblioref">2023</a>)</span>.</p>
<p>This involves three main steps:</p>
<ol type="1">
<li>
<strong>Create the graph</strong> representing the possible trajectory of the bird.</li>
<li>Set the <strong>movement model</strong> which defines the likelihood of each possible flight encoded in the graph.</li>
<li>
<strong>Compute three products</strong> of the model: (1) the most likely trajectory, (2) the probability maps at each stationary period (i.e., marginals), and (3) simulated paths sampled according to their likelihood.</li>
</ol>
<section id="background-on-movement-modeling" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="background-on-movement-modeling">
<span class="header-section-number">3.1</span> Background on movement modeling</h2>
<p>If you haven’t heard of <a href="https://en.wikipedia.org/wiki/Hidden_Markov_model" target="_blank">Hidden Markov model</a>, <a href="https://doi.org/10.1016/j.tree.2007.10.009" target="_blank">state-space models</a>, or <a href="https://en.wikipedia.org/wiki/Trellis_(graph)" target="_blank">trellis graphs</a>, I recommend that you start by reading the summary below, or - even better - read <span class="citation" data-cites="Patterson2008">Patterson et al. (<a href="resources.html#ref-Patterson2008" role="doc-biblioref">2008</a>)</span> and <span class="citation" data-cites="Nussbaumer2023b">Nussbaumer et al. (<a href="resources.html#ref-Nussbaumer2023b" role="doc-biblioref">2023</a>)</span> if you’re feeling brave!</p>
<details><summary>
Click here to read a short summary of movement model
</summary><div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We start by making the fundamental assumption that the overall trajectory can be separated into <strong>discrete</strong> positions which, together, create a trajectory.</p>
<p>This discretization allows us to use a <a href="https://en.wikipedia.org/wiki/Hidden_Markov_model" target="_blank">Hidden Markov model</a>, which conveniently distinguishes the <strong>unknown positions</strong> of a bird <span class="math inline">\(X_t\)</span> from some <strong>known observations</strong> <span class="math inline">\(Y_t\)</span> which can be related to these positions (e.g., pressure or light measurement). Defining an HMM requires that we set:</p>
<ol type="1">
<li>An <strong>observation model</strong> <span class="math inline">\(P(Y_t | X_t)\)</span>, which defines the likelihood of observing a measurement at a given position. This is exactly what our pressure likelihood map computed in the previous chapter does.</li>
<li>A <strong>movement model</strong> <span class="math inline">\(P(X_t+1|X_t)\)</span>, defining the probability that a bird was able to fly a specific distance between two consecutive stationary periods.</li>
<li>An <strong>initial state</strong> <span class="math inline">\(P(X_0)\)</span>, technically required but this does not constitute a strong constraint in our case.</li>
</ol>
<p>Let’s say that our goal is to produce the probability map for each stationary period accounting for all pressure measurements while maintaining likely flights. This corresponds to the <strong>marginal</strong> probability map <span class="math inline">\(P(X_t=x_t|Y_0=y_0,...Y_t=y_t)\)</span>. If you are not familiar with the lower and capital case, <span class="math inline">\(X_t\)</span> represents the random variable (i.e., the position of the bird at a stationary period <span class="math inline">\(t\)</span>), while <span class="math inline">\(x_t\)</span> is a specific value that <span class="math inline">\(X\)</span> can take, in our case, the specific coordinates of pixels on the map.</p>
<p>Because the number of possible positions is limited (i.e., number of pixels on the map), we can solve the HMM exactly. This is in contrast to Markov Chain Monte Carlo (MCMC) algorithm, which does not assume any discretization of space but relies on an iterative approach to solve the model.</p>
<p>A graph is a convenient mathematical representation of a model which has states (nodes) and relations between these states (edges). Graphs are a general and fundamental mathematical tool, but here we use a specific graph structure corresponding to the HMM presented above: two states <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> for each time step <span class="math inline">\(t\)</span> (nodes), and an observation and movement model (relating <span class="math inline">\(X_t\)</span> to <span class="math inline">\(X_t+1\)</span> and <span class="math inline">\(Y_t\)</span> to <span class="math inline">\(X_t\)</span> respectively). All other relationships are assumed to be independent.</p>
<p>Typically in animal movement, the graph is only used to represent the random variable of the HMM, but in our case, we also use the concept of graph to store all discrete positions (i.e., pixels) of the bird at all timesteps, referred to as a <a href="https://en.wikipedia.org/wiki/Trellis_(graph)" target="_blank">trellis graphs</a>.</p>
<p>You can think of the nodes as a full 3D grid of lat x lon x stationary period and the edges as all possible pairs of nodes between two consecutive stationary periods. As you can imagine, this results in a very high number of edges! The novelty of <span class="citation" data-cites="Nussbaumer2023b">Nussbaumer et al. (<a href="resources.html#ref-Nussbaumer2023b" role="doc-biblioref">2023</a>)</span> is to construct this graph using only the useful nodes and edges, thereby dramatically reducing the computational resources required.</p>
</div>
</div>
</details></section><section id="create-the-graph" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="create-the-graph">
<span class="header-section-number">3.2</span> Create the graph</h2>
<p>We create the trellis graph with the function <code>graph_create()</code>, which performs the following steps:</p>
<ol type="1">
<li>Keep only the nodes of all locations within a threshold percentile of the likelihood map <code>thr_likelihood</code>. For instance, a value of <code>0.90</code> means that We only keep the pixels for which their likelihood sums represent 90% of the total probability space.</li>
<li>Keep only the nodes which are within reach of at least one node of the previous and one of the next stationary period. This is done by assuming a maximal possible groundspeed <code>thr_gs</code>. This key step is efficiently computed with the image binary distance function <code><a href="https://rdrr.io/pkg/EBImage/man/distmap.html">EBImage::distmap()</a></code>.</li>
<li>Build the edges based on the filtered nodes and the groundspeed threshold <code>thr_gs</code>.</li>
<li>Prune the graph based on the flow graph constraint, that is, that all nodes must be connected to the equipment node(s) and retrieval node(s), to avoid dead branches (where some nodes are connected in a single direction).</li>
</ol>
<p>These steps are explained and illustrated in more detail in <a href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/2041-210X.14082#mee314082-sec-0004-title">section 2.2</a> of <span class="citation" data-cites="Nussbaumer2023b">Nussbaumer et al. (<a href="resources.html#ref-Nussbaumer2023b" role="doc-biblioref">2023</a>)</span></p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu">graph_create</span><span class="op">(</span><span class="va">tag</span>,</span>
<span>  thr_likelihood <span class="op">=</span> <span class="fl">0.90</span>,</span>
<span>  thr_gs <span class="op">=</span> <span class="fl">100</span>, <span class="co"># km/h</span></span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="set-movement-model" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="set-movement-model">
<span class="header-section-number">3.3</span> Set movement model</h2>
<p>We then define the movement model by setting a parametric function converting groundspeed to probability.</p>
<p>In this basic tutorial, we use the gamma distribution to model the probability of groundspeed.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu">graph_set_movement</span><span class="op">(</span><span class="va">graph</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>  shape <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  scale <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  low_speed_fix <span class="op">=</span> <span class="fl">15</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Because birds may fly back and forth over small distances, we give all groundspeeds under 15km/h the same probability as for 15 km/h with the parameter <code>low_speed_fix</code>.</p>
<p>We can visualize the parametric function created with <code>plot_graph_movement()</code></p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_graph_movement</span><span class="op">(</span><span class="va">graph</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="trajectory_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="products" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="products">
<span class="header-section-number">3.4</span> Products</h2>
<p>With the graph built, we can now generate the three main products of GeoPressureR, presented in more detail in <a href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/2041-210X.14082#mee314082-sec-0010-title">section 2.3</a> of <span class="citation" data-cites="Nussbaumer2023b">Nussbaumer et al. (<a href="resources.html#ref-Nussbaumer2023b" role="doc-biblioref">2023</a>)</span>.</p>
<section id="product-1-most-likely-path" class="level3" data-number="3.4.1"><h3 data-number="3.4.1" class="anchored" data-anchor-id="product-1-most-likely-path">
<span class="header-section-number">3.4.1</span> Product 1: Most likely path</h3>
<p>The graph can directly and efficiently compute the most likely path, that is, the set of positions at each stationary period which maximizes the joint probability of the trajectory. It finds the optimal compromise between the most likely position according to the pressure (and light) likelihood map and the realistic flight distance defined by the movement model.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">path_most_likely</span> <span class="op">&lt;-</span> <span class="fu">graph_most_likely</span><span class="op">(</span><span class="va">graph</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In GeoPressureR, a <code>path</code> is a standard data.frame created and used <a href="https://raphaelnussbaumer.com/GeoPressureR/reference/index.html#path">in several other functions</a>.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">kable</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">path_most_likely</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 6%">
</colgroup>
<thead><tr class="header">
<th style="text-align: right;">stap_id</th>
<th style="text-align: right;">j</th>
<th style="text-align: right;">ind</th>
<th style="text-align: right;">lat</th>
<th style="text-align: right;">lon</th>
<th style="text-align: left;">start</th>
<th style="text-align: left;">end</th>
<th style="text-align: left;">include</th>
<th style="text-align: right;">nb_sample</th>
<th style="text-align: left;">known</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2806</td>
<td style="text-align: right;">37.28681</td>
<td style="text-align: right;">-82.30497</td>
<td style="text-align: left;">2021-07-01 02:15:10</td>
<td style="text-align: left;">2021-09-24 00:15:10</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3056</td>
<td style="text-align: right;">32.25000</td>
<td style="text-align: right;">-80.75000</td>
<td style="text-align: left;">2021-09-24 11:15:10</td>
<td style="text-align: left;">2021-09-24 23:45:10</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">13</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3147</td>
<td style="text-align: right;">26.75000</td>
<td style="text-align: right;">-80.25000</td>
<td style="text-align: left;">2021-09-25 10:45:10</td>
<td style="text-align: left;">2021-09-25 23:45:10</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">14</td>
<td style="text-align: left;">FALSE</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_path</span><span class="op">(</span><span class="va">path_most_likely</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-197ba92133dced0b5dd5" style="width:100%;height:580px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-197ba92133dced0b5dd5">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addPolylines","args":[[[[{"lng":[-82.30497200000001,-80.75,-80.25,-84.25,-82.75,-82.75,-82.25,-82.25,-81.75],"lat":[37.286812,32.25,26.75,21.75,22.75,28.25,30.75,36.25,37.25]}]]],null,[1,1,1,1,1,1,1,1,1],{"interactive":true,"className":"","stroke":true,"color":"black","weight":5,"opacity":0.7,"fill":false,"fillColor":"black","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[[37.286812,32.25,26.75,21.75,22.75,28.25,30.75,36.25,37.25],[-82.30497200000001,-80.75,-80.25,-84.25,-82.75,-82.75,-82.25,-82.25,-81.75],[18.21375476728228,5.097132734541368,5.14735685560886,5.378750066974563,22.29624904030032,5.243610795028083,9.700841347437279,5.289814473047844,16.53865060807308],null,[1,1,1,1,1,1,1,1,1],{"interactive":true,"className":"","stroke":true,"color":"white","weight":2,"opacity":1,"fill":true,"fillColor":"grey","fillOpacity":0.8},null,null,null,null,["#1, 84.9 days","#2, 0.5 days","#3, 0.5 days","#4, 0.6 days","#5, 190.7 days","#6, 0.6 days","#7, 6.8 days","#8, 0.6 days","#9, 57.7 days"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[21.75,37.286812],"lng":[-84.25,-80.25]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section><section id="product-2-marginal-probability-map" class="level3" data-number="3.4.2"><h3 data-number="3.4.2" class="anchored" data-anchor-id="product-2-marginal-probability-map">
<span class="header-section-number">3.4.2</span> Product 2: Marginal probability map</h3>
<p>Estimating the uncertainty of the bird’s position for each stationary period is generally the most sought-after output of tracking studies. While the pressure likelihood map provides some information for each stationary period, we can now produce the probability map of positions accounting for all observations and transitions. In the HMM, these maps correspond to the marginal distribution of a Markov process.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">marginal</span> <span class="op">&lt;-</span> <span class="fu">graph_marginal</span><span class="op">(</span><span class="va">graph</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can visualize the marginal map along with the most likely path:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">marginal</span>, path <span class="op">=</span> <span class="va">path_most_likely</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-994ac5c9905de46f4f1b" style="width:100%;height:580px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-994ac5c9905de46f4f1b">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEEAAAFKCAYAAABCRzIyAAAEpElEQVR4nO3dTW7bVhiG0eOgg0yCrqDb6x68guyh2+sKCk88SycmwBqyREr8VZ8XMBInFikcfPczL3+uXn58//nLE+Xt/fVl7mu+rfFGzpYQhIAQEAJCQAgIASGA3/Z+A0vlniPFIVWCEBACQkAICAEhIAQ8CcIjB0o8CcKjCUEICAEHQ/j7n7922e+hEPZKCEJACDgYwh+//7nLfg+FsFdCEAJCQAgIASEgBISAEBACQkAICAEhIASEgJPfuPXoNcghVYIQEAJCwEkb41INcUiVIASEgBAQAkJACAgBJzpYWvoAaZwqQQgIASdBWLMfcBKEtROCEBACDn6wtHZDHFIlCAEh4MAIW/UDDoywZUIQAkLAQRG2bIocFGHrhCAEhIAQEAJCQAgIASEgBIQAXtZYy/3WBGjKPjuztHFCEALu6AnDWL31ujlj+tK26gkbJwQhIARMbIxbNKk9m2OVIASEgBu362x9JWivVAlCQAi4gvB/6QdUCQgBIeALhKP0g60+0LNKEAJCQAg40PMOb++vV0/wfP6/JZt3lSAEhIAvEPb61PFr4/zt/fVl+Fp6v1WCEBACQkAICAEh4IAnVabs+9Y8Y26qBCEgBHxxk8ZRTrR+zvBeW5lzhYQgBISAEBACQkAIOBnCWgdxp0JYKyEIASdEuNQXHj3BcjqENRKCELDzTRpTx/L4xOqlnjD+tx/ff/6aezxRJQgBIeBACNfG8bh33Lq5a+pjzOMcBmHPhCAE7HTxZbzPa8cAX43rucsS3Pr5KkEICAEr9YS527x1oXVub5g7f6gShIAQcGUljXv6wpLLDm25/SpBCAgBN1bXeXTpsHu39ci+bp2PvJQqQQgIARtdd9iiH0y9Rnnp56oEISAE3OgJ91zXWztLzT/G26kShIAQMGPJ4qnXBKa89pFc61P33Lv09v76UiVoOCAEzJg77LWwxKX38Pla5pxtjO9fGP5eJQgBIWCljzsZZ+m5x9xFp6acb6wShIAQcMKesEaqBCEgBPDtDGN27VQJQkAI4D/PDi298bP0mypBCAgBo54wzrU5+9K94wh9o0oQAkLAFz3hVp6tL1QJQsCdw2HIUsOi4XCAhCAEPIiw91heKlWCEBACFkB4hr5QJQgBIeDBucOl3Htr7dLvY06qBCEgBKzQEy5ly0eIp7yXz/urEoSAEPDkCD++//w1fA3fX/rzqRGmJgQhYCOEPeYG1x4RGr7v8Z9RQrDRYfOQJVf3mrv9a6tqVAlCQAjYuCcwf9XOe7c5NT01/5EQhICDIOz9RP4hEPZOCELADgh7X3K7lCpBCAgBO8wdhkw9t7D2UzjNHT4SghCwY08YZ8ql+68+MejR1BM+EoITIAylv+YDqodH2CIhCAE7f5DukDmHymukShACQsABEfY4/X44hD0SghBwkKn03CzZN5pKfyQEISAEhIAQEAJCQAgIASEgBISAEBACQkAICAEhIASEgBAQAkJACAgBISAEhICD3L02JWvewVIlCAEhIASEgBBwEoS1b/A8BcLaCUEICAEhIASEgAUR1vpdvsVDIFWCEBACFkbYew21e1MlCAEhlCH/AqSElmFfICwSAAAAAElFTkSuQmCC",[[39.98979129511279,-99.99999998608011],[-0.1993312115523441,-67.49999999060368]],null,"#1 | 01 Jul 02:15 - 24 Sep 00:15",{"tileSize":256,"zIndex":1,"minZoom":0,"opacity":0.8}]},{"method":"addRasterImage","args":["data:image/png;base64,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",[[39.98979129511279,-99.99999998608011],[-0.1993312115523441,-67.49999999060368]],null,"#2 | 24 Sep 11:15 - 24 Sep 23:45",{"tileSize":256,"zIndex":1,"minZoom":0,"opacity":0.8}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEEAAAFKCAYAAABCRzIyAAAF1UlEQVR4nO3dz2scZRwH4GfamIZKtIgeRC+CICj4JxS96MU/QMQiSvHiQUQPRrynHgqKHosHkZ56EbxZLx7EszcvCioUtKBtbEybZMdDs3FJk92d3fm14fOB0IbdzEyffueb951fW6yurJeOUTa21oqqP3OiiQ1ZtARBEBAEBAFBQBAQBAQBLHW9AXVllpHiMKkEQUAQEAQEAUFAEBAEHBOEeQZKHBOEeRMEQUAQEAQEAUFAEBAEBAFBQBAQBAQBQUAQEAQEAUFAEBAEBAFBQBAQBAQBQcCCX7g17znIYVIJgoAgIAhY0MZYV0McJpUgCAgCgoAgIAgIAoKABRos1T1AGk0qQRAQBCwIQpP9gAVBaDpBEAQEAT0fLDXdEIdJJQgCgoAeI7TVD+gxQpsJgiAgCOgpQptNkZ4itJ0gCAKCgCAgCAgCgoAgIAgIAoKAho42T5oATXp+/NmlS+V3O+dzZKnNBEEQMENPGO7v4/br1ZX1clxfOPjawWWdLk9W3ay5kkoQBAQBQQDFNB9808bR34Pb8eKdx10ZnMup+bYSBEHAhMFS22eCRvPcA6Urf7ezrlSCICAIGIPQZT84v/WE1z/8srX1pRIEAUHAEQhd9gPYRFGUBt8808oHeqYSBAFBQBDQI4TRZvzk6V2D7SU3z27uv37rz6fKa2+/Un797MXyszNf1Nowe4PQZYIgCDgCoatPHR/2he+3BtY/eM2Nt57ff+3+R34qHv3kcvHSj+8Wf2ws17reVIIgIAjo6X2RV5d/dxXXL72Az+95/a/deteXShAEBAE9PKgyuu7LK78c+p5PvVxcWLlc21gmlSAICAKOuEij6wOtR+Wrpz8ub/5z2rlf38yTOetOEAQBPZ07HJWff3vY9Vv1b3IqQRAQBAQBC4bwzsarxQ/F5uQ3VsxCITSVIAgCFhDh29037pk8PXjqwlwHWBYOoYkEQRDQ8QRqdWW9vK+8+/+wXQyslCcN/L97Lzlhs9ixsbVWPLZ8sRwoXbvz3j094cbt94vRZVY9KJRKEAQEAT1A2C4GtouBja21YqvYdacY7H9tFjuWyxMeOvVR+W+x43ax68yYMcFoP6hyoUnnCH1IEAQBHZ18GV3nxtba/jZMeqRAgbLi9k0zbkglCAKCgIZ6QtVlHtUTxi1v0vur/BtSCYKAIGDMkzRm6QuTxutN9Jo6lp9KEAQEAROerlN1jD7u9TrnI5O2edK442BSCYKAIKCl8w5t9IPD1jHtHCaVIAgIAib0hFnO6zWduuYfo8tJJQgCgoApn8zJ5HMCVX52nozrU7Pc6L6xtVakEmR3QBBQYe7Q1YMlDtuGg+cyqyxj9PqF4d9TCYKAIKDCOGHW1D33OLi90360yrj3pRIEAUHAAvaEJpJKEAQEAZxYhH226aQSBAFBwN3LhdHM8YJF6TepBEFAEDDSE0Yzbs5ed+/oQ99IJQgCgoAjesKkHLe+kEoQBMy4OwxT126R3aEHCYIgYE6ErvflupJKEAQEATUgHIe+kEoQBAQBc84dDsusl9bWvR1VkkoQBAQBDfSEw9LmLcTTbMvB9aUSBAFBwDFHWF1ZL4dfw+8P+/NYI0ybIAgCWkLoYm4w7hah4fe5/WckQdDSsHmYOp/uVXX5456qkUoQBAQBLfcEqj+1c9ZlTpvcNb+XIAgCeoLQ9R35vUDoOkEQBHSA0PUpt8OSShAEBAEdzB2GmfbYQtN34WTusJcgCAI67AmjmebU/VGfGDRv0hP2EgQLgDAs/SZvUO09QhsJgiCg4w/SHabKULmJpBIEAUFADxG6OPzeO4QuEgRBQE+m0lVTZ9/IVHovQRAEBAFBQBAQBAQBQUAQEAQEAUFAEBAEBAFBQBAQBAQBQUAQEAQEAUFAEBAEBAFBQE+uXpsmTV7BkkoQBAQBQUAQEAQsCELTF3guBELTCYIgIAgIAoKAIKBGhKZ+l7dxE0gqQRAQBNSM0PUz1GZNKkEQEIRkmP8AMdDYuPyEpBgAAAAASUVORK5CYII=",[[39.98979129511279,-99.99999998608011],[-0.1993312115523441,-67.49999999060368]],null,"#3 | 25 Sep 10:45 - 25 Sep 23:45",{"tileSize":256,"zIndex":1,"minZoom":0,"opacity":0.8}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEEAAAFKCAYAAABCRzIyAAAFMklEQVR4nO3dP2/saBnG4WsOf04ogpBAAkGz/daUfAJ6ECUSJRWiIC1IhGK1gu9AS0dHQQuipgZRoe0gWm1W7O5QcCzNZieT8cQee8LvlqJzojOxrUuPn/P6tf1mc311u/WCcnd/sxn7M6/mOJBLSwhCQAgIASEgBISAEMDnlz6AqXLKSHFIlSAEhIAQEAJCQAgIAS8E4TkDJV4IwnMTghAQAkJACAgBISAEhIAQEAJCQAgIASEgBISAEBACQkAICAEhIASEgBBw4Q9uPfce5JAqQQgIASHgQhvjVA1xSJUgBISAEBACQkAICAEXNFiaeoC0mypBCAgBF4IwZz/gQhDmTghCQAhY+WBp7oY4pEoQAkLAihHO1Q9YMcI5E4IQEAJWinDOpshKEc6dEISAEBACQkAICAEhIASEgBDAZo613J+6ADpmn80snTkhCAEn9IThXH3q58ac0/u2VU84c0IQAkLAkY3xHE1qyeZYJQgBIeCJx3XOfSdoqVQJQkAIOIDw/9IPqBIQAkLAIwhr6Qfn+oWeVYIQEAJCwIred7i7vzk4wfPw36Zs3lWCEBACHkFY6reOHzrP7+5vNsPX1PutEoSAEBACQkAICAErnFQ5Zt9PXWeMTZUgBISARx7SWMtE68MMx9rKnDMkBCEgBISAEBACQsCFIcw1iLsohLkSghBwgQj7+sJzJ1guDmGOhCAELPyQxvXV7fbvP/mLX/zye/76uQ9865PX3v7S1s8/+cenPnd3f7P55hff2b6/+ci/PvzZZ3rCbp+4vrrdjh1PVAlCQAhYAcJb737bV7+w9YePf7j5ztc/8I2vvf+Zz1xf3W7vXv3HdrM9OCbY7Qdjxg6LI6whIQgBC918+fX1b7c/+NHvvf7Vn33l9d8211e32z9995/e/t1vPrXfx87rscsSPPX5KkEICAEz9YSx23zvp9/ffvmt91z9+I97PzO2N4y9fqgShIAQcGAljVP6wqHx+gb/nqHX7ObUXlYlCAEh4InVdZ67dNip23rOvnYf9Dx2n1WCEBACznTf4Rz94Nh7lPs+VyUIASHgiZ5wyn29uTPVXMfudqoEISAEjFiy+OG5OOZe39TjhENzi2O3d3d/s6kSdDogBIy4dlhqYYl9x7B7LGP7ze7zC8PfqwQhIATM9OtOdjP1tcfYRaeOmW+sEoSAEHCBPWGOVAlCQAjg1SWcs3OnShACQsD/HiXCPPMFl9JvqgQhIATs9ITdHLpmn7p3rKFvVAlCQAh4pCc8lZfWF6oEIeDE02HIVKdFp8MKEoIQ8EyEpc/lqVIlCAEhYAKEl9AXqgQhIAQ889phX059tHbq4xiTKkEICAEz9IR9OecrxMccy8P9VQlCQAh44QjXV7fb4Wv4ft+fLxrh2IQgBJwJYYlrg0OvCA3f9/rPTkJwpmHzkClX9xq7/UOralQJQkAIOHNPYPyqnadu89j01vybhCAErARh6TfyV4GwdEIQAhZAWPqW275UCUJACFjg2mHIsXMLc7+F07XDm4QgBCzYE3ZzzK37h1PoU75mUCXodMAFIAylP+cLqqtHOEdCEAIW/kW6Q8YMledIlSAEhIAVIiwx/b46hCUSghCwkkvpsZmyb3Qp/SYhCAEhIASEgBAQAkJACAgBISAEhIAQEAJCQAgIASEgBISAEBACQkAICAEhIASs5Om1YzLnEyxVghAQAkJACAgBF4Iw9wOeF4Ewd0IQAkJACAgBIWBChLn+Lz/HSyBVghAQAiZGWHoNtVNTJQgBIZQh/wXuj6tr2l27FQAAAABJRU5ErkJggg==",[[39.98979129511279,-99.99999998608011],[-0.1993312115523441,-67.49999999060368]],null,"#4 | 26 Sep 12:45 - 27 Sep 04:15",{"tileSize":256,"zIndex":1,"minZoom":0,"opacity":0.8}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEEAAAFKCAYAAABCRzIyAAAExklEQVR4nO3dvW4jZRiG4SsrBCuhleg4GWoajoWGLh3dFjQ0iJbz4GBo0J5AhBQhoaXJSN7g2B57fsP9SNEmWXtmdOmdN/PNz+e7d2/ff/SK8vB4fzf2PW/m2JC9JQQhIASEgBAQAkJACOCztTdgqlxzpDikShACQkAICAEhIASEgFeCcMuBEq8E4daEIASEgBAQAkJACAgBISAEhIAQEAJCQAgIASEgBISAEBACQkAICAEhIATs/MatW69BDqkShIAQEAJ22hinaohDqgQhIASEgBAQAkJACNjRwdLUB0iHqRKEgBCwE4Q5+wE7QZg7IQgBIWDjB0tzN8QhVYIQEAI2jLBUP2DDCEsmBCEgBGwUYcmmyEYRlk4IQkAICAEhIASEgBAQAkJACOBujrnczw2ALllnZ5YWTghCwBU9YdhXz71vzD59bFn1hIUTghAQAi5sjEs0qTWbY5UgBISAM7frLH0laK1UCUJACDiB8H/pB1QJCAEh4AWErfSDpT7Qs0oQAkJACNjQ8w4Pj/cnT/A8/78pm3eVIASEgBcQ1vrU8VP7+cPj/d3wNfV6qwQhIASEgBAQAkLABk+qXLLuc+OMsakShIAQ8MJNGls50fo8w7Y2M+cMCUEICAEhIASEgBCwM4S5DuJ2hTBXQhACdohwrC/ceoJldwhzJAQhYOWbNIZ9+cOH3/zz5d/++uEb3//6rd8///OT1x2eWD3WEw5/9+7t+49jjyeqBCEgBGwE4eevf/TVF3/c/fTLd//pB3x6HHDu5q5LH2M+zCYQ1k4IQsBKF18O13nqGOCl/XrstATnXl8lCAEhYKaeMHaZ5y60ju0NY8cPVYIQEAJOzKRxTV+YctqhJZdfJQgBIeDM7Dq3Th127bJuWde585HHUiUIASFgoesOS/SDS69RHntdlSAEhIAzPeGa63pzZ6rxx+FyqgQhIASMmLL40msCl7z3lpzqU9fcu/TweH9XJWh3QAgYMXZYa2KJY9vw/FrmmGUc3r8wfF8lCAEhYKaPOznM1GOPsZNOXXK+sUoQAkLADnvCHKkShIAQwJs97LNzp0oQAkIAnzw7NPXC99JvqgQhIAQc9ITDnBqzT907ttA3qgQhIAS80BPO5bX1hSpBCLhydxgy1W7R7rCBhCAE3Iiw9r48VaoEISAETIDwGvpClSAEhIAbxw7Hcu2ttVNvx5hUCUJACJihJxzLko8QX7Itz9dXJQgBIeCVI7x7+/7j8DX8fOzfV41waUIQAhZCWGNscOoRoeHnHv85SAgWOmweMuXsXmOXf2pWjSpBCAgBC/cExs/aee0yL01PzT8lBCFgIwhrP5G/CYS1E4IQsALC2pfcjqVKEAJCwApjhyGXnluY+ymcxg5PCUEIWLEnHOaSS/cvfWLQraknPCUEO0AYSn/OB1Q3j7BEQhACVv4g3SFjDpXnSJUgBISADSKscfp9cwhrJAQhYCND6bGZsm80lH5KCEJACAgBISAEhIAQEAJCQAgIASEgBISAEBACQkAICAEhIASEgBAQAkJACAgBG7l77ZLMeQdLlSAEhIAQEAJCwE4Q5r7BcxcIcycEISAEhIAQEAImRJjrb/kSD4FUCUJACJgYYe051K5NlSAEhFCG/Atum58quvHOagAAAABJRU5ErkJggg==",[[39.98979129511279,-99.99999998608011],[-0.1993312115523441,-67.49999999060368]],null,"#5 | 27 Sep 08:15 - 06 Apr 00:45",{"tileSize":256,"zIndex":1,"minZoom":0,"opacity":0.8}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEEAAAFKCAYAAABCRzIyAAAE3klEQVR4nO3du24jZRjH4ScrkEKRmgKJy6LgGriBpUcrqKhoKBANd0HNZdBSQEMowkEKTQZ5F8f22HNy9PtLq90k6/Ho0fu9+b45+ebu9s2jF5T7h9c3Y1/zao4dubaEIASEgBAQAkJACAgBvLf2DkyVc2aKQ6oEISAEhIAQEAJCQAh4IQiXTJR4IQiXJgQhIASEgBAQAkJACAgBISAEhIAQEAJCQAgIASEgBISAEBACQkAICAEh4Mov3Lr0HOSQKkEICAEh4Eob41QNcUiVIASEgBAQAkJACAgBVzRZmnqCtJsqQQgIAVeCMGc/4EoQ5k4IQkAI2Phkae6GOKRKEAJCwIYRluoHbBhhyYQgBISAjSIs2RTZKMLSCUEICAEhIASEgBAQAkJACAgB3MzxLPdjC6BT3rMjSwsnBCHgjJ4wjNVjrxszpr+8/eHxj79f+fr9n896/aWpEoSAEBACTmyMSzSp7z/69vGz335d/H2pEhACQsARhPuH1zdLjctPfvrKdx/fLfFW/0uVIASEgAMIS58Z/vPDf/x+/8GSb/lfqgQhIAQ8g7B0P4Bv7r7w4y+3b31vqQ/0rBKEgBAQAjZ0v8Pnf3168ADPuz+bsnlXCUJACHgGYa1PHT80zocDPHNM5KoEISAEhIAQEAJCwIYOqox57/uH15NedVclCAEh4JmLNNbsCYcy7GtP5pwhIQgBISAEhIAQEAKuDGGuSdxVIcyVEISAK0TY1xcuPcBydQhzJAQhYOWLNE4dy7sHVvf1hN3v3d2+eRw7n6gShIAQsCGEQ+N4t3ccu7jr1NuYd7MZhDUTghCw0smX3fc8NAd4blyP2b9T5g1VghAQAmbqCWO3eexE69jeMHb9UCUIASHgwJM0zukLUz52aMntVwlCQAg48nSdsXP0Qz+fcj1ybJ/HXuBVJQgBIWCh8w5L9INTz1Hu+39VghAQAo70hHPO682dqdYfu9upEoSAEDDikcWnnhM45bWX5FCfOufapfuH1zdVgoYDQsCItcNaD5bYtw/vnsscs43d6xeGf1cJQkAImOnjTnYz9dpj7EOnTjneWCUIASHgCnvCHKkShIAQwKtrGLNzp0oQAkIAb907NPXGr6XfVAlCQAjY6Qm7ObRmn7p3bKFvVAlCQAh4piccy0vrC1WCEHDmcBgy1bBoOGwgIQgBFyKsPZanSpUgBISACRBeQl+oEoSAEHDh2mFfzr20dur9GJMqQQgIATP0hH1Z8hbiU/bl3ferEoSAEPDCEe5u3zwOf4av9/39ohFOTQhCwEIIa6wNDt0iNHzd7T87CcFC0+YhUz7da+z2Dz1Vo0oQAkLAwj2B8U/tPHebp6a75p8SghCwEYS178jfBMLaCUEIWAFh7VNu+1IlCAEhYIW1w5BTjy3MfRdOa4enhCAErNgTdnPKqfvnPjHo0tQTnhKCK0AYSn/OG1Q3j7BEQhACVv4g3SFjpspzpEoQAkLABhHWOPy+OYQ1EoIQsJGl9NhM2TdaSj8lBCEgBISAEBACQkAICAEhIASEgBAQAkJACAgBISAEhIAQEAJCQAgIASEgBISAjVy9dkrmvIKlShACQkAICAEh4EoQ5r7A8yoQ5k4IQkAICAEhIARMiDDX7/IlbgKpEoSAEDAxwtrPUDs3VYIQEEIZ8i9K2KVuM7KGOQAAAABJRU5ErkJggg==",[[39.98979129511279,-99.99999998608011],[-0.1993312115523441,-67.49999999060368]],null,"#6 | 06 Apr 10:15 - 07 Apr 00:15",{"tileSize":256,"zIndex":1,"minZoom":0,"opacity":0.8}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEEAAAFKCAYAAABCRzIyAAAEuElEQVR4nO3dPW4bVxiG0SMjAZxCC0iZfWRV6bQCAVlC1pOdpEgdqBHgwmk0ACNQ5Aw5v8rzAoItW5whDr77ae78XD48fn3+7hPl5fXpYeprvizxRo6WEISAEBACQkAICAEhgB+2fgNz5ZYjxSFVghAQAkJACAgBISAEfBKEew6U+CQI9yYEISAEhIAQEAJCQAgIASEgBISAEBACQkAICAEhIASEgBAQAkJACAgBIeDgN27dew1ySJUgBISAEHDQxjhXQxxSJQgBISAEhIAQEAJCwIEOluY+QDpNlSAEhICDICzZDzgIwtIJQQgIATs/WFq6IQ6pEoSAELBjhLX6ATtGWDMhCAEhYKcIazZFdoqwdkIQAnaE8Ou3n/31zx+b7Hs3CFsmBCEgBOwI4c8f//b7T89++/bL6vveDcKWCUEI4GGJtdyvTYDG7LMzSysnBCHghp4wjNVrr5syps9tq56wckIQAkLAyMa4RpPasjlWCUJACLhyu87aV4K2SpUgBISACwj/l35AlYAQEAI+QNhLP1jrAz2rBCEgBISAHT3v8PL6dPEEz/v/m7N5VwlCQAj4AGGrTx2/NM5fXp8ehq+591slCAEhIASEgBAQAnZ4UmXMvq/NM6amShACQsAHN2ns5UTr+wzvtZU5F0gIQkAICAEhIASEgIMhLHUQdyiEpRKCEHBAhHN94d4TLIdDWCIhCAEb36Qxdiyfnlg91xNO/+3x6/P3qccTVYIQEAJ2hHBpHJ/2jms3d419jPk0u0HYMiEIARtdfDnd56VjgI/G9dRlCa79fJUgBISAhXrC1G1eu9A6tTdMnT9UCUJACLiwksYtfWHOZYfW3H6VIASEgCur69y7dNit27pnX9fOR55LlSAEhICVrjus0Q/GXqM893NVghAQAq70hFuu6y2dueYfp9upEoSAEDBhyeKx1wTGvPaeXOpTt9y79PL69FAlaDggBEyYO2y1sMS59/D+WuaUbZzevzD8vUoQAkLAQh93cpq55x5TF50ac76xShACQsABe8ISqRKEgBDAlyOM2aVTJQgBIYD/PDs098aP0m+qBCEgBJz0hNNcmrPP3Tv20DeqBCEgBHzQE67ls/WFKkEIuHE4DJlrWDQcdpAQhIA7EbYey3OlShACQsAMCJ+hL1QJQkAIuHPucC633lo79/uYkipBCAgBC/SEc1nzEeIx7+X9/qoEISAEfHKEx6/P34ev4ftzf35qhLEJQQhYCWGLucGlR4SG73v85yQhWOmwecicq3tN3f6lVTWqBCEgBKzcE5i+auet2xybnpp/SwhCwE4Qtn4ifxcIWycEIWADhK0vuZ1LlSAEhIAN5g5Dxp5bWPopnOYObwlBCNiwJ5xmzKX7jz4x6N7UE94SggMgDKW/5AOqu0dYIyEIARt/kO6QKYfKS6RKEAJCwA4Rtjj9vjuELRKCELCTqfTUzNk3mkq/JQQhIASEgBAQAkJACAgBISAEhIAQEAJCQAgIASEgBISAEBACQkAICAEhIASEgJ3cvTYmS97BUiUIASEgBISAEHAQhKVv8DwEwtIJQQgIASEgBISAGRGW+l2+xkMgVYIQEAJmRth6DbVbUyUIASGUIf8CKbqbd/f8nk0AAAAASUVORK5CYII=",[[39.98979129511279,-99.99999998608011],[-0.1993312115523441,-67.49999999060368]],null,"#7 | 07 Apr 04:45 - 14 Apr 00:45",{"tileSize":256,"zIndex":1,"minZoom":0,"opacity":0.8}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEEAAAFKCAYAAABCRzIyAAAE+UlEQVR4nO3dzYocVRjH4Wc04myC4j4LwY0LL8abyD1k6yb3EPAavBgXbgQR96LMJoISNyloQ093VXd99fj7w5BM0lPVPLznnTr1cfru+f3rd55QHt6+upv6Mx8t8UZuLSEIASEgBISAEBACQgDPtn4D5/LVP5/7+eM/zr7ukiPFIVWCEBACdo7w8q8vR/WDa7NrhLUSghAQAnaM8N0nL7z59JdRr73mQIkdI6yZEISAELBThK///sKvD+tNcHeJsHZCEAJCwA4RfviGn5797vv7cUeLc2R3CFskBCFgZwi//fnGtz+uv99dIWyVEISAELAzhBefvdxkv7tC2CohCAEhIASEgBAQAm7gxq1TufYa5JAqQQgIASHgRhvjXA1xSJUgBISAEBACQkAICAE3dLA09wHSYaoEISAE3AjCkv2AG0FYOiEIASFg5wdLSzfEIVWCEBACdoywVj9gxwhrJgQhIATsFGHNpshOEdZOCEJACAgBISAEhIAQEAJCQAjgbom13M9NgMbsszNLKycEIeCCnjCM1XM/N2VMH9tWPWHlhCAEhICRjXGNJrVlc6wShIAQcOZ2nbWvBG2VKkEICAEnEP4v/YAqASEgBDyCsJd+sNYHelYJQkAICAE7et7h4e2rkyd4Pvy/OZt3lSAEhIBHELb61PFT4/zh7au74Wvu/VYJQkAICAEhIASEgB2eVBmz73PzjKmpEoSAEPDITRp7OdH6YYb32sqcCyQEISAEhIAQEAJCwI0hLHUQd1MISyUEIeAGEY71hWtPsNwcwhIJQQjY+CaNsWP58MTqsZ5w+G/P71+/m3o8USUIASFgRwinxvFh7zh3c9fYx5gPsxuELROCELDRxZfDfZ46BnhsXE9dluDc66sEISAELNQTpm7z3IXWqb1h6vyhShACQsCJlTQu6QtzLju05varBCEgBJxZXefapcMu3dY1+zp3PvJYqgQhIASsdN1hjX4w9hrlsddVCUJACDjTEy65rrd05pp/HG6nShACQsCEJYvHXhMY87PX5FSfuuTepYe3r+6qBA0HhIAJc4etFpY49h4+vJY5ZRuH9y8Mf68ShIAQsNDHnRxm7rnH1EWnxpxvrBKEgBBwgz1hiVQJQkAI4KNbGLNLp0oQAkIA/3l2aO6N30q/qRKEgBBw0BMOc2rOPnfv2EPfqBKEgBDwSE84l6fWF6oEIeDC4TBkrmHRcNhBQhACrkTYeizPlSpBCAgBMyA8hb5QJQgBIeDKucOxXHpr7dzvY0qqBCEgBCzQE45lzUeIx7yXD/dXJQgBIeCJIzy/f/1u+Bq+P/bnk0YYmxCEgJUQtpgbnHpEaPi+x38OEoKVDpuHzLm619Ttn1pVo0oQAkLAyj2B6at2XrrNsemp+fcJQQjYCcLWT+TvAmHrhCAEbICw9SW3Y6kShIAQsMHcYcjYcwtLP4XT3OF9QhACNuwJhxlz6f6xTwy6NvWE9wnBDSAMpb/kA6q7R1gjIQgBG3+Q7pAph8pLpEoQAkLADhG2OP2+O4QtEoIQsJOp9NTM2TeaSr9PCEJACAgBISAEhIAQEAJCQAgIASEgBISAEBACQkAICAEhIASEgBAQAkJACAgBO7l7bUyWvIOlShACQkAICAEh4EYQlr7B8yYQlk4IQkAICAEhIATMiLDU7/I1HgKpEoSAEDAzwtZrqF2aKkEICKEM+RfHWqcwkD7+fwAAAABJRU5ErkJggg==",[[39.98979129511279,-99.99999998608011],[-0.1993312115523441,-67.49999999060368]],null,"#8 | 14 Apr 10:45 - 15 Apr 01:15",{"tileSize":256,"zIndex":1,"minZoom":0,"opacity":0.8}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEEAAAFKCAYAAABCRzIyAAAEpElEQVR4nO3dTW7bVhiG0eOgg0yCrqDb6x68guyh2+sKCk88SycmwBqyREr8VZ8XMBInFikcfPczL3+uXn58//nLE+Xt/fVl7mu+rfFGzpYQhIAQEAJCQAgIASGA3/Z+A0vlniPFIVWCEBACQkAICAEhIAQ8CcIjB0o8CcKjCUEICAEHRPj7n7823+fhEPZICEJACDggwh+//7n5Pg+HsEdCEAJCQAgIASEgBISAEBACQkAICAEhIASEgJPfuPXoNcghVYIQEAJCwEkb41INcUiVIASEgBAQAkJACAgBJzpYWvoAaZwqQQgIASdBWLMfcBKEtROCEBACDn6wtHZDHFIlCAEh4MAIW/UDDoywZUIQAkLAQRG2bIocFGHrhCAEhIAQEAJCQAgIASEgBIQAXtZYy/3WBGjKPjuztHFCEALu6AnDWL31ujlj+tK26gkbJwQhIARMbIxbNKk9m2OVIASEgBu362x9JWivVAlCQAi4gvB/6QdUCQgBIeALhKP0g60+0LNKEAJCQAg40PMOb++vV0/wfP6/JZt3lSAEhIAvEPb61PFr4/zt/fVl+Fp6v1WCEBACQkAICAEh4IAnVabs+9Y8Y26qBCEgBHxxk8ZRTrR+zvBeW5lzhYQgBISAEBACQkAIOBnCWgdxp0JYKyEIASdEuNQXHj3BcjqENRKCELDzTRpTx/L4xOqlnjD+tx/ff/6aezxRJQgBIeBACNfG8bh33Lq5a+pjzOMcBmHPhCAE7HTxZbzPa8cAX43rucsS3Pr5KkEICAEr9YS527x1oXVub5g7f6gShIAQcGUljXv6wpLLDm25/SpBCAgBN1bXeXTpsHu39ci+bp2PvJQqQQgIARtdd9iiH0y9Rnnp56oEISAE3OgJ91zXWztLzT/G26kShIAQMGPJ4qnXBKa89pFc61P33Lv09v76UiVoOCAEzJg77LWwxKX38Pla5pxtjO9fGP5eJQgBIWCljzsZZ+m5x9xFp6acb6wShIAQcMKesEaqBCEgBPDtDGN27VQJQkAI4D/PDi298bP0mypBCAgBo54wzrU5+9K94wh9o0oQAkLAFz3hVp6tL1QJQsCdw2HIUsOi4XCAhCAEPIiw91heKlWCEBACFkB4hr5QJQgBIeDBucOl3Htr7dLvY06qBCEgBKzQEy5ly0eIp7yXz/urEoSAEPDkCD++//w1fA3fX/rzqRGmJgQhYCOEPeYG1x4RGr7v8Z9RQrDRYfOQJVf3mrv9a6tqVAlCQAjYuCcwf9XOe7c5NT01/5EQhICDIOz9RP4hEPZOCELADgh7X3K7lCpBCAgBO8wdhkw9t7D2UzjNHT4SghCwY08YZ8ql+68+MejR1BM+EoITIAylv+YDqodH2CIhCAE7f5DukDmHymukShACQsABEfY4/X44hD0SghBwkKn03CzZN5pKfyQEISAEhIAQEAJCQAgIASEgBISAEBACQkAICAEhIASEgBAQAkJACAgBISAEhICD3L02JWvewVIlCAEhIASEgBBwEoS1b/A8BcLaCUEICAEhIASEgAUR1vpdvsVDIFWCEBACFkbYew21e1MlCAEhlCH/ApiElmFM5y9AAAAAAElFTkSuQmCC",[[39.98979129511279,-99.99999998608011],[-0.1993312115523441,-67.49999999060368]],null,"#9 | 15 Apr 05:15 - 11 Jun 22:45",{"tileSize":256,"zIndex":1,"minZoom":0,"opacity":0.8}]},{"method":"addCircleMarkers","args":[37.286812,-82.30497200000001,10,null,null,{"interactive":true,"className":"","stroke":true,"color":"white","weight":2,"opacity":0.5,"fill":true,"fillColor":"red","fillOpacity":1},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addPolylines","args":[[[[{"lng":[-82.30497200000001,-80.75,-80.25,-84.25,-82.75,-82.75,-82.25,-82.25,-81.75],"lat":[37.286812,32.25,26.75,21.75,22.75,28.25,30.75,36.25,37.25]}]]],null,[1,1,1,1,1,1,1,1,1],{"interactive":true,"className":"","stroke":true,"color":"black","weight":5,"opacity":0.7,"fill":false,"fillColor":"black","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[[37.286812,32.25,26.75,21.75,22.75,28.25,30.75,36.25,37.25],[-82.30497200000001,-80.75,-80.25,-84.25,-82.75,-82.75,-82.25,-82.25,-81.75],[18.21375476728228,5.097132734541368,5.14735685560886,5.378750066974563,22.29624904030032,5.243610795028083,9.700841347437279,5.289814473047844,16.53865060807308],null,[1,1,1,1,1,1,1,1,1],{"interactive":true,"className":"","stroke":true,"color":"white","weight":2,"opacity":1,"fill":true,"fillColor":"grey","fillOpacity":0.8},null,null,null,null,["#1, 84.9 days","#2, 0.5 days","#3, 0.5 days","#4, 0.6 days","#5, 190.7 days","#6, 0.6 days","#7, 6.8 days","#8, 0.6 days","#9, 57.7 days"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[37.286812,-82.30497200000001,18.21375476728228,null,"#1 | 01 Jul 02:15 - 24 Sep 00:15",{"interactive":true,"className":"","stroke":true,"color":"white","weight":2,"opacity":1,"fill":true,"fillColor":"black","fillOpacity":1},null,null,null,null,"#1, 84.9 days",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[32.25,-80.75,5.097132734541368,null,"#2 | 24 Sep 11:15 - 24 Sep 23:45",{"interactive":true,"className":"","stroke":true,"color":"white","weight":2,"opacity":1,"fill":true,"fillColor":"black","fillOpacity":1},null,null,null,null,"#2, 0.5 days",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[26.75,-80.25,5.14735685560886,null,"#3 | 25 Sep 10:45 - 25 Sep 23:45",{"interactive":true,"className":"","stroke":true,"color":"white","weight":2,"opacity":1,"fill":true,"fillColor":"black","fillOpacity":1},null,null,null,null,"#3, 0.5 days",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[21.75,-84.25,5.378750066974563,null,"#4 | 26 Sep 12:45 - 27 Sep 04:15",{"interactive":true,"className":"","stroke":true,"color":"white","weight":2,"opacity":1,"fill":true,"fillColor":"black","fillOpacity":1},null,null,null,null,"#4, 0.6 days",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[22.75,-82.75,22.29624904030032,null,"#5 | 27 Sep 08:15 - 06 Apr 00:45",{"interactive":true,"className":"","stroke":true,"color":"white","weight":2,"opacity":1,"fill":true,"fillColor":"black","fillOpacity":1},null,null,null,null,"#5, 190.7 days",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[28.25,-82.75,5.243610795028083,null,"#6 | 06 Apr 10:15 - 07 Apr 00:15",{"interactive":true,"className":"","stroke":true,"color":"white","weight":2,"opacity":1,"fill":true,"fillColor":"black","fillOpacity":1},null,null,null,null,"#6, 0.6 days",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[30.75,-82.25,9.700841347437279,null,"#7 | 07 Apr 04:45 - 14 Apr 00:45",{"interactive":true,"className":"","stroke":true,"color":"white","weight":2,"opacity":1,"fill":true,"fillColor":"black","fillOpacity":1},null,null,null,null,"#7, 6.8 days",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[36.25,-82.25,5.289814473047844,null,"#8 | 14 Apr 10:45 - 15 Apr 01:15",{"interactive":true,"className":"","stroke":true,"color":"white","weight":2,"opacity":1,"fill":true,"fillColor":"black","fillOpacity":1},null,null,null,null,"#8, 0.6 days",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[37.25,-81.75,16.53865060807308,null,"#9 | 15 Apr 05:15 - 11 Jun 22:45",{"interactive":true,"className":"","stroke":true,"color":"white","weight":2,"opacity":1,"fill":true,"fillColor":"black","fillOpacity":1},null,null,null,null,"#9, 57.7 days",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLayersControl","args":[["#1 | 01 Jul 02:15 - 24 Sep 00:15","#2 | 24 Sep 11:15 - 24 Sep 23:45","#3 | 25 Sep 10:45 - 25 Sep 23:45","#4 | 26 Sep 12:45 - 27 Sep 04:15","#5 | 27 Sep 08:15 - 06 Apr 00:45","#6 | 06 Apr 10:15 - 07 Apr 00:15","#7 | 07 Apr 04:45 - 14 Apr 00:45","#8 | 14 Apr 10:45 - 15 Apr 01:15","#9 | 15 Apr 05:15 - 11 Jun 22:45"],[],{"collapsed":false,"autoZIndex":true,"position":"topright"}]}],"limits":{"lat":[-0.1993312115523441,39.98979129511279],"lng":[-99.99999998608011,-67.49999999060368]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section><section id="product-3-simulated-paths" class="level3" data-number="3.4.3"><h3 data-number="3.4.3" class="anchored" data-anchor-id="product-3-simulated-paths">
<span class="header-section-number">3.4.3</span> Product 3: Simulated paths</h3>
<p>When you want to perform a post-hoc computation on the trajectory (e.g., mean flight distance), it is convenient to simulate multiple paths, compute the metric on each of them (e.g., flight distance) and compute the summary statistics afterwards (e.g., mean).</p>
<p>Note that we are using the forward filtering backward sampling algorithm, allowing to sample trajectories independently and without error.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">path_simulation</span> <span class="op">&lt;-</span> <span class="fu">graph_simulation</span><span class="op">(</span><span class="va">graph</span>,</span>
<span>  nj <span class="op">=</span> <span class="fl">10</span>, <span class="co"># Number of simulation</span></span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_path</span><span class="op">(</span><span class="va">path_simulation</span>, plot_leaflet <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="trajectory_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="save" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="save">
<span class="header-section-number">3.5</span> Save</h2>
<p>You might want to save some of the key objects such as <code>tag</code> or <code>marginal</code> in an <code>R</code> format. Following the default structure described in <a href="https://github.com/Rafnuss/GeoPressureTemplate#project-structure-file_folder">GeoPressureTemplate</a>, you should save them in the <code>"./data/interim"</code> folder.</p>
<p>Note that <code>graph</code> can be quite large if the number of stationary periods and grid resolution is high.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">tag</span>,</span>
<span>  <span class="va">graph</span>, <span class="co"># format(object.size(graph), units = "MB")</span></span>
<span>  <span class="va">path_most_likely</span>,</span>
<span>  <span class="va">path_simulation</span>,</span>
<span>  <span class="va">marginal</span>,</span>
<span>  file <span class="op">=</span> <span class="st">"./data/interim/CB619.RData"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When saving <code>tag</code> and <code>graph</code>, you also archive the functions parameters used, which can be retrieved with <code>tag$param</code> and <code>graph$param</code>.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Nussbaumer2023b" class="csl-entry" role="listitem">
Nussbaumer, Raphaël, Mathieu Gravey, Martins Briedis, Felix Liechti, and Daniel Sheldon. 2023. <span>“<span class="nocase">Reconstructing bird trajectories from pressure and wind data using a highly optimized hidden Markov model</span>.”</span> <em>Methods in Ecology and Evolution</em> 2023 (February): 1–12. <a href="https://doi.org/10.1111/2041-210X.14082">https://doi.org/10.1111/2041-210X.14082</a>.
</div>
<div id="ref-Patterson2008" class="csl-entry" role="listitem">
Patterson, Toby A., Len Thomas, Chris Wilcox, Otso Ovaskainen, and Jason Matthiopoulos. 2008. <span>“<span class="nocase">State-space models of individual animal movement</span>.”</span> <em>Trends in Ecology and Evolution</em> 23 (2): 87–94. <a href="https://doi.org/10.1016/j.tree.2007.10.009">https://doi.org/10.1016/j.tree.2007.10.009</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/raphaelnussbaumer\.com\/GeoPressureManual\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./pressure-map.html" class="pagination-link" aria-label="Pressure map">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Pressure map</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./light-map.html" class="pagination-link" aria-label="Light map">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Light map</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">

<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/Rafnuss/GeoPressureManual/issues" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>